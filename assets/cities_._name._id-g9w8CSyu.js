import{u as g,d as h,r as v,e as p,j as e,f as S,p as A,h as T,i as R,a as j,A as E}from"./index-DkWwHGoj.js";import{g as y,f as C,S as w,C as P,B as L}from"./spinner-B85kF9iE.js";import{g as O,b as F,c as H,H as I}from"./header-Buxdmxk0.js";import{M as G}from"./Map-DJe_MJMV.js";import{P as k}from"./page-not-found-DvrgjE_9.js";const $=()=>{const t=g(),s=h.useParams(),[n,a]=v.useState(null),[r,i]=v.useState(""),c=l=>{t(A(l))},u=l=>{l.preventDefault(),n!==null&&r.length>=p.MIN_COMMENT_LENGTH&&(c({id:Number(s.id),comment:r,rating:Number(n)}),i(""),a(null))},x=r.length>=p.MIN_COMMENT_LENGTH&&r.length<=p.MAX_COMMENT_LENGTH&&n!==null;return e.jsxs("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:u,children:[e.jsx("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),e.jsx("div",{className:"reviews__rating-form form__rating",children:Array.from({length:p.STAR_RATING_MAX},(l,m)=>m).map((l,m)=>{const o=p.STAR_RATING_MAX-m;return e.jsxs(S.Fragment,{children:[e.jsx("input",{className:"form__rating-input visually-hidden",name:"rating",value:o,id:`${o}-stars`,type:"radio",onChange:N=>{a(N.target.value)},checked:n===String(o)},`${o}-star`),e.jsx("label",{htmlFor:`${o}-stars`,className:"reviews__rating-label form__rating-label",title:"perfect",children:e.jsx("svg",{className:"form__star-image",width:"37",height:"33",children:e.jsx("use",{xlinkHref:"#icon-star"})})})]},`${o}-star-input`)})}),e.jsx("textarea",{className:"reviews__textarea form__textarea",required:!0,minLength:p.MIN_COMMENT_LENGTH,maxLength:p.MAX_COMMENT_LENGTH,id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",value:r,onInput:l=>{i(l.target.value)}}),e.jsxs("div",{className:"reviews__button-wrapper",children:[e.jsxs("p",{className:"reviews__help",children:["To submit review please make sure to set"," ",e.jsx("span",{className:"reviews__star",children:"rating"})," and describe your stay with at least"," ",e.jsxs("b",{className:"reviews__text-amount",children:[p.MIN_COMMENT_LENGTH," characters"]}),"."]}),e.jsx("button",{className:"reviews__submit form__submit button",type:"submit",disabled:!x,children:"Submit"})]})]})},B=t=>{const{user:s,rating:n,comment:a,date:r}=t,{name:i,avatarUrl:c}=s;return e.jsxs("li",{className:"reviews__item",children:[e.jsxs("div",{className:"reviews__user user",children:[e.jsx("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:e.jsx("img",{className:"reviews__avatar user__avatar",src:c,width:54,height:54,alt:"Reviews avatar"})}),e.jsx("span",{className:"reviews__user-name",children:i})]}),e.jsxs("div",{className:"reviews__info",children:[e.jsx("div",{className:"reviews__rating rating",children:e.jsxs("div",{className:"reviews__stars rating__stars",children:[e.jsx("span",{style:{width:y(n)}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]})}),e.jsx("p",{className:"reviews__text",children:a}),e.jsx("time",{className:"reviews__time",dateTime:r,children:C(r)})]})]})},D=({[T.SiteData]:t})=>t.reviews,X=()=>{const t=h.useParams(),s=g();v.useEffect(()=>{const{id:i}=t;if(i){const c=Number(i);s(R(c))}},[t,s]);const a=j(O)===E.Auth,r=j(D);return e.jsxs("section",{className:"property__reviews reviews",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"reviews__title",children:["Reviews ·"," ",e.jsx("span",{className:"reviews__amount",children:r.length})]}),e.jsx("ul",{className:"reviews__list",children:r.map(i=>e.jsx(B,{...i},i.id))})]}),a&&e.jsx($,{})]})},z=()=>{const{id:t}=h.useParams(),{data:s,isLoading:n}=F(t);return n&&!s?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"property",children:e.jsx(G,{locations:s.map(a=>a.location),city:s[0].city,place:"property"})}),e.jsx("div",{className:"container",children:e.jsxs("section",{className:"near-places places",children:[e.jsx("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),e.jsx("div",{className:"near-places__list places__list",children:s.map(a=>e.jsx(P,{offer:a},a.id))})]})})]})},U=()=>{const{id:t}=h.useParams(),{data:s,isLoading:n}=H(t);if(!s)return e.jsx(k,{});if(n&&!s)return e.jsx(w,{});const{title:a,type:r,price:i,rating:c,isPremium:u,isFavorite:x,images:l,bedrooms:m,maxAdults:o,goods:N,host:_,description:f,id:b}=s,M=l.slice(0,6);return e.jsxs("div",{className:"page",children:[e.jsx(I,{}),e.jsxs("main",{className:"page__main page__main--property",children:[e.jsxs("section",{className:"property",children:[e.jsx("div",{className:"property__gallery-container container",children:e.jsx("div",{className:"property__gallery",children:M.map(d=>e.jsx("div",{className:"property__image-wrapper",children:e.jsx("img",{className:"property__image",src:d,alt:a})},d))})}),e.jsx("div",{className:"property__container container",children:e.jsxs("div",{className:"property__wrapper",children:[u&&e.jsx("div",{className:"property__mark",children:e.jsx("span",{children:"Premium"})}),e.jsxs("div",{className:"property__name-wrapper",children:[e.jsx("h1",{className:"property__name",children:a}),e.jsx(L,{placement:"property",isFavorite:x,id:b})]}),e.jsxs("div",{className:"property__rating rating",children:[e.jsxs("div",{className:"property__stars rating__stars",children:[e.jsx("span",{style:{width:y(c)}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]}),e.jsx("span",{className:"property__rating-value rating__value",children:c})]}),e.jsxs("ul",{className:"property__features",children:[e.jsx("li",{className:"property__feature property__feature--entire",children:r}),e.jsxs("li",{className:"property__feature property__feature--bedrooms",children:[m," Bedrooms"]}),e.jsxs("li",{className:"property__feature property__feature--adults",children:["Max ",o," adults"]})]}),e.jsxs("div",{className:"property__price",children:[e.jsxs("b",{className:"property__price-value",children:["€",i]}),e.jsx("span",{className:"property__price-text",children:" night"})]}),e.jsxs("div",{className:"property__inside",children:[e.jsx("h2",{className:"property__inside-title",children:"What's inside"}),e.jsx("ul",{className:"property__inside-list",children:N.map(d=>e.jsx("li",{className:"property__inside-item",children:d},d))})]}),e.jsxs("div",{className:"property__host",children:[e.jsx("h2",{className:"property__host-title",children:"Meet the host"}),e.jsxs("div",{className:"property__host-user user",children:[e.jsx("div",{className:["property__avatar-wrapper user__avatar-wrapper",_.isPro&&"property__avatar-wrapper--pro"].join(" "),children:e.jsx("img",{className:"property__avatar user__avatar",src:_.avatarUrl,width:"74",height:"74",alt:`Host ${_.name} avatar`})}),e.jsx("span",{className:"property__user-name",children:_.name}),_.isPro&&e.jsx("span",{className:"property__user-status",children:"Pro"})]}),e.jsx("div",{className:"property__description",children:e.jsx("p",{className:"property__text",children:f})})]}),e.jsx(X,{})]})})]}),e.jsx(z,{})]})]})},Q=U;export{Q as component};
